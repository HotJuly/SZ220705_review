# key值

1. key值的用法
   1. 在遍历循环产生节点的时候,会给每个节点都添加上唯一标识key属性
      1. 使用v-for的时候才会使用到
2. 常用作key值的数据
   1. 遍历得到数据身上的唯一标识,例如:id,vid等
   2. 遍历得到的下标,例如index
   3. 遍历得到的数据本身,但是数据类型必须是基本数据类型
3. key值的作用
   1. 与diff算法有关,可以优化性能
   2. 当遍历的数据发生变化的时候,那么Vue会根据最新数据创建全新的虚拟DOM树,并与旧的虚拟DOM树进行比较,key值就是比较的关键数据,找到可以复用的真实DOM节点,进行复用
   3. first render(首次渲染)
      1. 将template字符串编译成render函数
      2. 传入状态数据,调用render函数,生成虚拟DOM树
      3. 根据虚拟DOM树,生成真实DOM树
      4. 将真实DOM树替换掉页面上的el元素
      5. 最终GUI线程,根据真实DOM树的结果,渲染在页面上
      6. 注意:**首次渲染中,没有diff算法参与**
   4. update render(更新渲染)
      1. 传入最新的数据,调用render函数,生成全新的虚拟DOM树
      2. 比较新旧两棵虚拟DOM树,找到可以复用的真实DOM
      3. 如果没有可以复用的真实DOM,就生成全新的真实DOM
      4. 结果会得到一个新的真实DOM树,并替换掉页面上指定的区域
      5. 最终GUI线程,根据真实DOM树的结果,渲染在页面上
      6. 注意:
         1. **流程2,3就是所谓的diff算法**
         2. diff算法比较属于同级比较,不会跨层级比较
4. 如果使用下标作为key值,可能会出现的问题?
   1. 如果遍历的数据后续不会发生变化,那么用下标作为key值也不一定会有问题
   2. input案例
      1. 该案例中,diff算法有在持续比较虚拟DOM,也复用真实DOM了,但是最终复用错了节点,导致显示错误
   3. 商品排序案例
      1. 该案例中,diff算法有在持续比较虚拟DOM,没有复用成功真实DOM,全部创建全新的,本来该场景应该是最完美的复用场景,结果diff算法不仅没有优化性能,反而劣化性能
5. 使用唯一标识作为key值的好处是什么?
   1. 只要服务器返回的数据和标识的关系不发生变化,前端的节点就可以一直复用下去