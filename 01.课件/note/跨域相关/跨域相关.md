#  跨域相关

1. 问题一:什么是跨域

   1. 跨域就是违反了浏览器的同源策略

   2. 问题:同源策略是什么?

      1. 两个URL的协议名,域名,端口三者都相同,那么就说明这两个URL是同源的

      2. URL的组成部分:协议名+域名+端口号+查询字符串

         1. 查询字符串是由接口路径+请求参数组合而成

      3. ```javascript
         //例子一:以下两个链接协议名不同,所以不同源
         http://localhost:8080/home
         ftp://localhost:8080/home

         //例子二:以下两个链接的域名不同,所以不同源
         http://localhost:8080/home
         http://127.0.0.1:8080/home

         //例子二:以下两个链接只有查询字符串不同,但是查询字符串同源判断范围之内,所以同源
         http://localhost:8080/home
         http://localhost:8080/about
         ```

         ​

      4. 问题:为什么要有跨域报错?

         1. 前沿:真网站成为A网站,假网站成为B网站
         2. 如果跨域不报错,会导致的结果,用户在不知情的情况下,请求了B网站,B网站返回html文件给浏览器,浏览器自动解析执行该网页的js代码,js代码中会使用ajax往A网站 发送请求,并将A网站的cookie携带发送,A网站得到cookie数据之后,返回个人真实数据,最终数据被B网站接收
         3. 这个过程中,用户直接损失了个人的真实数据,而A网站损失用户

2. 问题二:跨域一定会报错吗?

   1. 不一定会报错
   2. 服务器之间跨域不会报错
   3. video/audio/link/script/img等标签跨域也不会报错
   4. 小总结:**跨域是一个动作,他不一定会带了严重结果**

3. 问题三:什么情况下会出现跨域问题

   1. 在浏览器上会出现
   2. 在发送ajax请求的时候,才会出现
   3. 小总结:**跨域问题是浏览器搞的鬼**

4. 问题四:哪些请求算是ajax请求(ajax->async javascript and xml)

   1. 只有使用js发送的请求,才有可能是ajax请求
   2. 无论是http还是ajax,最终服务器接收到的都是http请求
   3. 小总结:**ajax请求并不是一种特殊的请求,ajax只是一种发送请求的技术**

5. 跨域问题解决方案

   1. JSONP
      1. 原理:利用了script标签,请求跨域资源不会报错的漏洞来实现的
      2. 流程:
         1. 前端在网页中,准备好存储数据的变量data和接收数据的函数getData
         2. 当用户点击按钮时,创建一个script标签,并给对其进行src属性赋值
            1. src的属性值应该是后端指定的接口
         3. 在添加src中,需要把前端的函数名称getData传递给后端
         4. 后端服务器接收到请求,需要根据得到的函数名称以及想要返回的数据,组合成一个全新字符串,并返回
         5. 浏览器的script接收到服务器返回的字符串,会自动执行内部代码
         6. 最终前端的getData函数会被调用,得到后端传递的数据
      3. 优点:
         1. 该方案上线之后也能使用
         2. 可以实现不同域名之间的请求,只要对方公司配合
      4. 缺点:
         1. 只能发送get请求
         2. 前端需要准备函数,后端需要准备接口,所以都很麻烦
   2. CORS
   3. proxy




