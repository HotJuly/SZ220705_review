<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
    /*
        async和await
            async和await其实是promise+.then的语法糖
            async和await是解决回调地狱的终极方案
            async和await实现了让开发者可以以同步的流程书写异步的代码

            async关键字
                async关键字可以脱离await单独使用
                async关键字需要写在函数声明之前

                async函数的返回值:
                    一定是一个全新的promise对象(简称p1)
                        变为成功
                            1.只要async函数中的代码,成功执行结束,那么p1就是成功
                            2.只要async函数返回一个成功的promise对象,那么p1就是成功

                        变为失败
                            1.只要async函数中的代码,出现报错无法正常执行,那么p1就是失败
                            2.只要async函数返回一个失败的promise对象,那么p1就是失败
                            3.如果await右侧的promise是失败状态,那么p1就是失败

                    注意:async函数中如果return数据,那么该数据就会成为p1的结果值

            await关键字
                await关键字不能脱离async单独使用
                    扩展:在最新的ES语法中,await已经允许在顶层作用域中单独使用

                await关键字,可以拦截后续代码的执行,但是范围仅限于async函数内部
                    其实await就是.then
                    注意:
                        1.await虽然会拦截后续代码执行,但是右侧代码还是会同步执行的
                        2.无论await右侧的promise是立即功,还是延迟成功,后续代码都是在微任务中执行

                await表达式的结果,就是右侧promise对象的结果值
                    await表达式右侧如果是一个非promise对象的数据,那么就会将该数据作为await的返回值
                

                
    */

    async function fn(){
        console.log(1)
        var result = await new Promise((resolve,reject)=>{
            console.log(5)
            // setTimeout(resolve,2000);
            // resolve(333);
            reject()
        })
        // var result = await 123;
        console.log(2,result)

        // throw new Error();

        // return Promise.resolve();
        // return Promise.reject();

        // return 333;
    }

    console.log(3);
    var p1 = fn();

    // await axios();
    console.log(4,p1);

    //--------------------------
    // function fn(){
    //     console.log(1)
    //     return new Promise((resolve)=>{
    //         console.log(5)
    //         resolve()
    //     })
    //     .then(()=>{
    //         console.log(2)
    //     })
    // }

    // console.log(3);
    // fn();
    // console.log(4);
    </script>
  </body>
</html>
